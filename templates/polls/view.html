{% extends "base.html" %}

{% block title %}{{ poll.title }} | –ß—Ç–æ –Ω–∞ –æ–±–µ–¥?{% endblock %}

{% block content %}
<div class="card">
    <h2 class="card-title">{{ poll.title }}</h2>
    
    <div class="card-meta">
        {% if poll.creator_id %}
            <p>–°–æ–∑–¥–∞—Ç–µ–ª—å: {{ poll.creator.username }}</p>
        {% elif poll.creator_name %}
            <p>–°–æ–∑–¥–∞—Ç–µ–ª—å: {{ poll.creator_name }}</p>
        {% endif %}
        
        <p>–°–æ–∑–¥–∞–Ω: {{ poll.created_at.strftime('%d.%m.%Y %H:%M') }}</p>
        
        {% if poll.deadline %}
            <p>
                –î–µ–¥–ª–∞–π–Ω: 
                <span id="poll-deadline" data-deadline="{{ poll.deadline.isoformat() }}">
                    {{ poll.deadline.strftime('%d.%m.%Y %H:%M') }}
                </span>
            </p>
        {% endif %}
    </div>
    
    {% if poll.description %}
        <p class="poll-description">{{ poll.description }}</p>
    {% endif %}
    
    <div class="share-poll">
        <button id="copy-poll-link" class="btn btn-secondary" data-link="{{ url_for('polls.view', poll_hash=poll.url_hash, _external=True) }}">
            –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
        </button>
    </div>
    
    <hr>
    
    <form method="POST" action="{{ url_for('polls.view', poll_hash=poll.url_hash) }}">
        {{ form.hidden_tag() }}
        
        <div class="form-group">
            {{ form.voter_name.label }}
            {{ form.voter_name(class="form-control") }}
            {% for error in form.voter_name.errors %}
                <span class="error">{{ error }}</span>
            {% endfor %}
        </div>
        
        <div class="vote-options">
            <h3>–ü—Ä–æ–≥–æ–ª–æ—Å—É–π—Ç–µ –∑–∞ –≤–∞—Ä–∏–∞–Ω—Ç—ã:</h3>
            
            {% for option in options %}
                <div class="vote-option">
                    <h4>{{ option.name }}</h4>
                    
                    {% if option.description %}
                        <p>{{ option.description }}</p>
                    {% endif %}
                    
                    <input type="hidden" id="vote_{{ option.id }}" name="vote_{{ option.id }}" value="0">
                    
                    <div class="vote-buttons">
                        <button type="button" class="vote-button dislike" data-option-id="{{ option.id }}" data-vote-type="-1">
                            üëé –ù–µ —Ö–æ—á—É
                        </button>
                        <button type="button" class="vote-button neutral active" data-option-id="{{ option.id }}" data-vote-type="0">
                            üòê –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ
                        </button>
                        <button type="button" class="vote-button like" data-option-id="{{ option.id }}" data-vote-type="1">
                            üëç –•–æ—á—É
                        </button>
                    </div>
                </div>
            {% endfor %}
        </div>
        
        <div class="form-group">
            {{ form.submit(class="btn") }}
        </div>
    </form>
</div>
{% endblock %}